## ØªØ´Ø®ÙŠØµ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙˆØ§Ù„Ø­Ù„

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:
ØªÙ… Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¨Ù†Ø¬Ø§Ø­ØŒ ÙˆÙ„ÙƒÙ† Ø¯Ø¹Ù†ÙŠ Ø£ÙˆØ¶Ø­ Ù…Ø§ ÙƒØ§Ù† ÙŠØ­Ø¯Ø«:

1. **Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø®Ø§Ø·Ø¦Ø© ÙÙŠ Ø¯Ù„ÙŠÙ„ Nginx**: 
   - ÙƒØ§Ù† Ø§Ù„Ø¯Ù„ÙŠÙ„ `/var/www/idealbody25.online/` ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ù„ÙØ§Øª Vite Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ React Ø§Ù„ÙØ¹Ù„ÙŠ
   - Ù…Ù„Ù [index.html](file://c:\Users\Lenovo\Desktop\ifb-main\frontend_build_v\index.html) ÙƒØ§Ù† ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ Ù…Ù„ÙØ§Øª JavaScript Ùˆ CSS Ø®Ø§Ø·Ø¦Ø©

2. **Ù…Ø³Ø§Ø± ØºÙŠØ± ØµØ­ÙŠØ­ ÙÙŠ Ø§Ù„Ø£Ù…Ø±**:
   - Ø§Ù„Ø£Ù…Ø± `sudo cp -r /path/to/correct/frontend_build/* /var/www/idealbody25.online/` ÙƒØ§Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø±	placeholder ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙØ¹Ù„ÙŠÙ‹Ø§
   - ÙƒØ§Ù† ÙŠØ¬Ø¨ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ `/path/to/correct/frontend_build` Ø¨Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ÙØ¹Ù„ÙŠ

### Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ø·Ø¨Ù‚:

1. **ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ØµØ­ÙŠØ­**:
   ```bash
   find / -type d -name "frontend_build" 2>/dev/null | grep -v node_modules
   ```
   ÙˆÙ‡Ø°Ø§ Ø£Ø¸Ù‡Ø± Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©:
   - `/fatemaifb/frontend_build`
   - `/root/ifb/frontend_build`

2. **Ù†Ø³Ø® Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©**:
   ```bash
   sudo cp -r /fatemaifb/frontend_build/* /var/www/idealbody25.online/
   ```

3. **ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©**:
   ```bash
   sudo chown -R www-data:www-data /var/www/idealbody25.online
   sudo chmod -R 755 /var/www/idealbody25.online
   ```

4. **Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†ØªÙŠØ¬Ø©**:
   - ØªÙ… Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ù…Ù„Ù [index.html](file://c:\Users\Lenovo\Desktop\ifb-main\frontend_build_v\index.html) ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ Ø§Ù„ØªÙƒÙˆÙŠÙ† Ø§Ù„ØµØ­ÙŠØ­ Ù„ØªØ·Ø¨ÙŠÙ‚ React
   - ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ ØªÙƒÙˆÙŠÙ† Nginx Ø¨Ù†Ø¬Ø§Ø­

### Ø§Ù„Ù†ØªÙŠØ¬Ø©:
Ø§Ù„Ø¢Ù† ÙŠØªÙ… Ø¹Ø±Ø¶ ÙˆØ§Ø¬Ù‡Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰:
- https://idealbody25.online/dashboard
- https://idealbody25.online/login

Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø³ÙˆØ¯Ø§Ø¡ Ø§Ù„ØªÙŠ ÙƒØ§Ù†Øª ØªØ¸Ù‡Ø± Ø³Ø§Ø¨Ù‚Ù‹Ø§.
*--------------
Ø±Ø§Ø¦Ø¹! ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø±Ø¤ÙŠØ© Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø¢Ù†. Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø®Ø±Ø¬Ø§Øª Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ØªÙŠ Ù‚Ø¯Ù…ØªÙ‡Ø§ØŒ Ø£Ø³ØªØ·ÙŠØ¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¨Ø§Ù„Ø¶Ø¨Ø·:

## ğŸ” Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:
ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ù„Ù ØµØ­ÙŠØ­Ø© Ø§Ù„Ø¢Ù†:
```
-rwxr-xr-x 1 root www-data 89273 Sep 23 08:46 759575533.jpg
```

Ù„ÙƒÙ† Ù„Ø§ ØªØ²Ø§Ù„ ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø®Ø·Ø£ **403 Forbidden**. Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ØªÙƒÙ…Ù† ÙÙŠ **Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Nginx**ØŒ ØªØ­Ø¯ÙŠØ¯Ø§Ù‹ ÙÙŠ ÙƒÙŠÙÙŠØ© Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙˆØ¬ÙŠÙ‡ `alias`.

## ğŸ“Œ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ:
ØªÙˆØ¬ÙŠÙ‡ `alias` ÙÙŠ Nginx ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ `/root/ifb/` ÙˆÙ„ÙƒÙ† Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ£ØªÙŠ Ø·Ù„Ø¨ Ù„Ù€:
```
/api/query/food/foodImages/images/759575533.jpg
```

ÙŠØ­Ø§ÙˆÙ„ Nginx Ø¹Ø±Ø¶:
```
/root/ifb/food/foodImages/images/759575533.jpg
```

Ù„ÙƒÙ† Ø§Ù„Ù…Ù„Ù Ø§Ù„ÙØ¹Ù„ÙŠ Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ:
```
/root/ifb/query/food/foodImages/images/759575533.jpg
```

Ù„Ø§Ø­Ø¸ Ø£Ù† Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø°ÙŠ ÙŠØ¨Ø­Ø« Ø¹Ù†Ù‡ Nginx ÙŠÙ†Ù‚ØµÙ‡ Ù…Ø¬Ù„Ø¯ `query/`.

## âœ… Ø§Ù„Ø­Ù„:

### Ø¹Ø¯Ù‘Ù„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Nginx Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ:

Ø§Ø³ØªØ¨Ø¯Ù„ Ù‚Ø³Ù… `location /api/query/` Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨Ù€:

```nginx
# Ø¥ØµÙ„Ø§Ø­ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© Ù„Ù…Ø¬Ù„Ø¯ query
location /api/query/ {
    alias /root/ifb/query/;  # Ø£Ø´Ø± Ø¥Ù„Ù‰ Ù…Ø¬Ù„Ø¯ queryØŒ ÙˆÙ„ÙŠØ³ /root/ifb/
    expires 1y;
    add_header Cache-Control "public, immutable";
    access_log off;
    
    # Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
    location ~* \.(jpg|jpeg|png|gif|svg|mp4|avi|mov|pdf|webp)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
        access_log off;
        try_files $uri =404;
    }
}
```

## ğŸ§ª Ø§Ø®ØªØ¨Ø± Ø§Ù„Ø¥ØµÙ„Ø§Ø­:

1. **Ø§Ø®ØªØ¨Ø± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Nginx:**
   ```bash
   sudo nginx -t
   ```

2. **Ø£Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Nginx Ø¥Ø°Ø§ Ù†Ø¬Ø­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:**
   ```bash
   sudo systemctl reload nginx
   ```

3. **Ø¬Ø±Ù‘Ø¨ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ØµÙˆØ±Ø©:**
   `https://idealbody25.online/api/query/food/foodImages/images/759575533.jpg`

## ğŸ¯ Ø§Ù„Ù†Ù‚Ø·Ø© Ø§Ù„Ù…Ù‡Ù…Ø©:
Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø­Ø§Ø³Ù… Ù‡Ùˆ ØªØºÙŠÙŠØ±:
- âŒ `alias /root/ifb/;` 
- âœ… `alias /root/ifb/query/;`

Ù‡Ø°Ø§ ÙŠØ¶Ù…Ù† Ø£Ù† Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªÙ„Ù‚Ù‰ Nginx Ø·Ù„Ø¨Ø§Ù‹ Ù„Ù€ `/api/query/food/...`ØŒ ÙŠÙ‚ÙˆÙ… Ø¨ØªØ­ÙˆÙŠÙ„Ù‡ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ Ø¥Ù„Ù‰ `/root/ifb/query/food/...` Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† `/root/ifb/food/...`.

ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ù„ÙØ§ØªÙƒ ØµØ­ÙŠØ­Ø© Ø¨Ø§Ù„ÙØ¹Ù„! Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙƒØ§Ù†Øª ÙÙŠ ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø³Ø§Ø± ÙÙ‚Ø· ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Nginx.

-------------------------------------------------------

# HTTP redirect to HTTPS
server {
    listen 80;
    server_name idealbody25.online www.idealbody25.online;
    return 301 https://$server_name$request_uri;
}

# HTTPS server
server {
    listen 443 ssl http2;
    server_name idealbody25.online www.idealbody25.online;

    # SSL certificates
    ssl_certificate /etc/letsencrypt/live/idealbody25.online/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/idealbody25.online/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;

    # â­â­ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ØµØ­ÙŠØ­ - ØªØ£ÙƒØ¯ Ø£Ù†Ù‡ /var/www/idealbody25.online â­â­
    root /var/www/idealbody25.online;
    index index.html;

    client_max_body_size 150M;

    # 1. Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© Ø£ÙˆÙ„Ø§Ù‹
    location /assets/ {
        access_log off;
        add_header Cache-Control "public, max-age=31536000, immutable";
        try_files $uri =404;
        expires 1y;
    }

    location ~* \.(js|css|png|jpg|jpeg|gif|svg|ico|woff2?|ttf|eot|mp4)$ {
        access_log off;
        add_header Cache-Control "public, max-age=31536000, immutable";
        try_files $uri =404;
        expires 1y;
    }
   location = /favicon.ico {
        log_not_found off;
        access_log off;
        try_files /favicon.ico =404;
    }

    location = /vite.svg {
        log_not_found off;
        access_log off;
        try_files /vite.svg =404;
    }

    # 2. phpMyAdmin
    location /phpmyadmin/ {
        alias /usr/share/phpmyadmin/;
        index index.php;

        location ~ \.php$ {
            include snippets/fastcgi-php.conf;
            fastcgi_pass unix:/var/run/php/php8.4-fpm.sock;
            fastcgi_param SCRIPT_FILENAME $request_filename;
        }

        location ~* \.(css|js|png|jpg|jpeg|gif|ico|svg|ttf|woff|woff2)$ {
            try_files $uri =404;
            access_log off;
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
    }

# API proxy with static file exception
location /api/ {
    # Exception for query static files
    location /api/query/ {
        alias /root/ifb/query/;  # Point directly to the query directory
        expires 1y;
        add_header Cache-Control "public, immutable";
        access_log off;

        # Allow specific file types
        location ~* \.(jpg|jpeg|png|gif|svg|mp4|avi|mov|pdf|webp)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
            access_log off;
            try_files $uri =404;
        }
    }

    # All other API requests go to Node.js
    client_max_body_size 150M;
    proxy_pass http://127.0.0.1:3118;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;

    proxy_connect_timeout 300s;
    proxy_send_timeout 300s;
    proxy_read_timeout 300s;
}




    # â­â­â­ 4. SPA routing - Ø§Ù„Ø­Ù„ Ø§Ù„Ø¬Ø°Ø±ÙŠ â­â­â­

location / {
    root /var/www/idealbody25.online;
    index index.html;
    try_files $uri $uri/ /index.html;
    add_header X-SPA-Routing "active" always;
    add_header X-Request-Path "$uri" always;
    access_log /var/log/nginx/spa.log;
}



}
